{
    "contents" : "###############################################################################\n#\n#  1. Download and read data into R\n#\n###############################################################################\n\nrequire(RCurl)\ntrainURL <- \"https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv\"\ntestURL <- \"https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv\"\nif (any(!file.exists(\"./data/train.csv\") | !file.exists(\"./data/train.csv\"))) {\n        dir.create(\"data\")\n        download.file(trainURL,\n                      destfile=\"./data/train.csv\",\n                      method = \"curl\")\n        download.file(testURL,\n                      destfile=\"./data/test.csv\",\n                      method = \"curl\")\n}\n\nif (any(!exists(\"train\") | !exists(\"test\"))) {\n        test <- read.csv(\"./data/test.csv\",\n                         header=TRUE,\n                         stringsAsFactors=F,\n                         na.strings=c(\"\", \"NA\", \"#DIV/0!\"))\n        train <- read.csv(\"./data/train.csv\",\n                          header=TRUE,\n                          stringsAsFactors=F,\n                          na.strings=c(\"\", \"NA\", \"#DIV/0!\"))\n}\n\n###############################################################################\n#\n#  2. Choose column data relating to sensors\n#\n###############################################################################\nt <- train[grep(\"belt|forearm|arm|dumbbell|classe\", colnames(train))]\nte <- test[grep(\"belt|forearm|arm|dumbbell|problem_id\", colnames(test))]\n\n\n###############################################################################\n#\n#  3. Make sure data are in the right format for regression\n#\n###############################################################################\nt1 <- as.data.frame(sapply(t[1:152], \"as.numeric\"))\nte1 <- as.data.frame(sapply(te[1:152], \"as.numeric\"))\nt1$classe <- factor(t$classe)\nte1$problem_id <- factor(te$problem_id)\n\n###############################################################################\n#\n#  4. Remove near-zero-variance variables and simplify variable names\n#\n###############################################################################\nlibrary(caret)\nzeroVar <- nearZeroVar(t1)\nt2 <- t1[, -zeroVar]\nte2 <- te1[, -zeroVar]\nt2Colnames <- colnames(t2)\nt3 <- t2\nte3 <- te2\ncolnames(t3)[1:117] <- as.character(1:117)\ncolnames(te3)[1:117] <- as.character(1:117)\n\n###############################################################################\n#\n#  5. Train model\n#\n###############################################################################\nlibrary(doMC)\nregisterDoMC(cores = 2)\nctrl <- trainControl(method = \"repeatedcv\",\n                     repeats = 5,\n                     number = 10)\n\n# test-time model\ninTrain <- createDataPartition(t3$classe, p=.1, list = FALSE)\nt4 <- t3[inTrain,]\nc50TuneCtrl <- train(x =t4[, -118],\n                     y=t4[,118],\n                     method = \"C5.0\",\n                     trControl = ctrl)\n\n# final model\nc50TuneFinal <- train(x =t3[, -118],\n                      y=t3[,118],\n                      method = \"C5.0\",\n                      preProc = c(\"center\", \"scale\"),\n                      trControl = ctrl)\n\n# times\nc50TuneCtrl$times$everything\nc50TuneFinal$times$everything\n\n# Accuracy of the final model\nc50TuneFinal\n\n###############################################################################\n#\n#  5. Predict (Coursera assignment)\n#\n###############################################################################\n\nanswers <- predict(c50TuneFinal, newdata=te3[,-118])\n",
    "created" : 1408812771181.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2806149202",
    "id" : "81BC151",
    "lastKnownWriteTime" : 1408906204,
    "path" : "/home/sergey/R_COURSERA_Machine_Learning_Project/run-analysis.R",
    "project_path" : "run-analysis.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}